When creating the new virtual machines in VMWare, set the encryption password to password123!!
(this will allow you to start up the VMs on a different device)

In the Virtual Machine Settings, Under "Device status", enable "Connect at power on". This is required to boot from the ISO image.

Step 1: Initialize Domain Controller
1. Download Windows Server 2025: https://www.microsoft.com/en-us/evalcenter/download-windows-server-2025
2. In the Virtual Machine Settings, insert the ISO. Under "Device status", enable "Connect at power on".
3. Boot and Install Windows Server 2025 (Desktop Edition).
4. Fully Update the System and Install VMWare Tools
5. Shut down, change the network adapter to VMNet1 (Host Only). Do not set a second network adapter.
6. Boot the VM and run the DC01.ps1 script. Continue running the script after the computer restarts.
7. When the setup is complete, the script will output "Setup Complete".
8. Add a second (NAT) network adapter and sync the domain controller with an external time source
9. Keep the domain controller (DC01) running at all times.


Step 2: Initialize Kali
1. Open "Virtual Network Editor" from the VMWare "Edit" menu. Click "Change Settings" and confirm the UAC prompt. Set the bridged network adapter to bridge to your ethernet controller and click "OK". Ensure an ethernet cable is connected. This will allow file sharing with your host through a samba share.
2. Boot Kali, set up, and start a Samba Share, following the documentation in KALI.txt
3. Transfer Instructions.docx and powershell.lnk to Kali
4. Run the setup script (KALI.sh)
5. Update /etc/network/interfaces and /etc/resolv.conf, following the documentation in KALI.txt
6. Shut down Kali, change the network adapter to VMNet1, and start Kali again.
7. Confirm Connectivity to the domain controller, following the documentation in KALI.txt


Step 3: Join Member Workstations to the Domain using domain-join.ps1 PowerShell script

1. Ensure the Windows 11 Enterprise VM is fully updated
2. Ensure VMWare Tools is installed
3. Ensure the first network adapter is set to VMNet1 and the second network adapter is set to NAT
4. Ensure tamper protection is disabled, and the computer is set to never go to sleep.
5. Here are the computer names and corresponding IP addresses. You will input these when running the domain-join.ps1 script.
Computer names and corresponding host IPs:
WEB01 - 10.10.14.20                    Log in as: Aaron: tt.r.2006 (Local Admin)
WEB02 - 10.10.14.40                    Log in as: iis_service: daisy_3 (Local Admin); Betty: pinky.1995 (Standard User)
DMZ01 - 10.10.14.60                    Log in as: Chris: abcABC123!@# (Local Admin)
MAIL01 - 10.10.14.80                   Log in as: Daniela: c/o2010 (Local Admin)
DEV01 - 10.10.14.100                   Log in as: Ernesto: lucky#1 (Local Admin); Daniela: c/o2010 (Standard User)
ADMIN04 - 10.10.14.120                 Log in as: Francesca: bubbelinbunny_1 (Local Admin)
ADMIN03 - 10.10.14.140                 Log in as: Francesca: bubbelinbunny_1 (Local Admin)
ADMIN02 - 10.10.14.160                 Log in as: Helen: chase#1 (Local Admin)
ADMIN01 - 10.10.14.180                 Log in as: Helen: chase#1 (Local Admin)
FILES01 - 10.10.14.200                 Log in as: Issac: passw0rd!! (Local Admin)
6. To make a user a local admin, open an elevated PowerShell (using Domain Admin credentials in the UAC prompt), and run the following command
net localgroup Administrators /add ad\[User]
7. Then restart the computer. You can now open an elevated PowerShell session, as the user is a member of the Local Administrations group.


Step 4: Set up Attack Boxes using their PowerShell scripts
1. Make sure Windows Security is initialized, then run the scripts
2. If the computer restarts, resume running the script until it outputs: "Script completed successfully."


Step 5: Final steps
1. Ensure the Windows Defender exclusions were successfully applied on WEB01, WEB02, DMZ01, DEV01, ADMIN01.
2. WEB02 - Log in as Betty, to cache a domain credential.
3. DMZ01 - Manually run the Send-Email command in PowerShell, to save the clue.
4. DEV01 - After running DEV01.ps1, log in as Daniela and run DEV01-Part2.ps1
5. ADMIN02 - Download Instructions.docx to Helen's home directory, prior to running script
